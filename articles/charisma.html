<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Getting Started • charisma</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Raleway-0.4.10/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Chelsea_Market-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Getting Started">
<link rel="stylesheet" href="extra.css">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">charisma</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/charisma.html">Get Started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/charisma.html">Getting Started</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/shawntz/charisma" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Getting Started</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/shawntz/charisma/blob/main/vignettes/charisma.Rmd" class="external-link"><code>vignettes/charisma.Rmd</code></a></small>
      <div class="d-none name"><code>charisma.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>charisma</code> package provides a standardized and
reproducible framework for characterizing and classifying discrete color
classes from digital images of biological organisms. This vignette walks
you through the basic workflow and demonstrates key features of the
package.</p>
<div class="section level3">
<h3 id="what-does-charisma-do">What does charisma do?<a class="anchor" aria-label="anchor" href="#what-does-charisma-do"></a>
</h3>
<p><code>charisma</code> automatically determines the presence or
absence of 10 human-visible color categories in images:</p>
<ul>
<li>
<strong>black</strong>, <strong>blue</strong>,
<strong>brown</strong>, <strong>green</strong>,
<strong>grey</strong>
</li>
<li>
<strong>orange</strong>, <strong>purple</strong>,
<strong>red</strong>, <strong>white</strong>,
<strong>yellow</strong>
</li>
</ul>
<p>The package uses a biologically-inspired Color Look-Up Table (CLUT)
that partitions HSV color space into non-overlapping regions, ensuring
each color maps to exactly one category.</p>
</div>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="section level3">
<h3 id="system-dependencies">System Dependencies<a class="anchor" aria-label="anchor" href="#system-dependencies"></a>
</h3>
<p><code>charisma</code> depends on spatial R packages that require
system-level libraries. Install these first:</p>
<p><strong>macOS (via Homebrew):</strong></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">brew</span> install udunits gdal proj geos</span></code></pre></div>
<p><strong>Ubuntu/Debian:</strong></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">sudo</span> apt-get install libudunits2-dev libgdal-dev libgeos-dev libproj-dev</span></code></pre></div>
<p><strong>Fedora/RedHat:</strong></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">sudo</span> dnf install udunits2-devel gdal-devel geos-devel proj-devel</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="development-version-github">Development Version (GitHub)<a class="anchor" aria-label="anchor" href="#development-version-github"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("remotes")</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"shawntz/charisma"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="stable-version-cran">Stable Version (CRAN)<a class="anchor" aria-label="anchor" href="#stable-version-cran"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"charisma"</span><span class="op">)</span>  <span class="co"># Coming soon!</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="load-the-package">Load the Package<a class="anchor" aria-label="anchor" href="#load-the-package"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/shawntz/charisma" class="external-link">charisma</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="basic-workflow">Basic Workflow<a class="anchor" aria-label="anchor" href="#basic-workflow"></a>
</h2>
<div class="section level3">
<h3 id="step-1-load-an-image">Step 1: Load an Image<a class="anchor" aria-label="anchor" href="#step-1-load-an-image"></a>
</h3>
<p>The package includes an example image of a colorful fish
(<em>Anampses caeruleopunctatus</em>):</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">img_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>  <span class="st">"extdata"</span>,</span>
<span>  <span class="st">"Anampses_caeruleopunctatus.png"</span>,</span>
<span>  package <span class="op">=</span> <span class="st">"charisma"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-2-run-charisma">Step 2: Run charisma<a class="anchor" aria-label="anchor" href="#step-2-run-charisma"></a>
</h3>
<p>The simplest analysis uses default parameters:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/charisma.html">charisma</a></span><span class="op">(</span></span>
<span>  <span class="va">img_path</span>,</span>
<span>  threshold <span class="op">=</span> <span class="fl">0.0</span>,</span>
<span>  interactive <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  pavo <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Key parameters:</strong></p>
<ul>
<li>
<code>threshold</code>: Minimum proportion of pixels for a color to
be retained (0-1)</li>
<li>
<code>interactive</code>: Enable manual color
merging/replacement</li>
<li>
<code>plot</code>: Show diagnostic plots during processing</li>
<li>
<code>pavo</code>: Compute color pattern geometry statistics</li>
</ul>
</div>
<div class="section level3">
<h3 id="step-3-visualize-results">Step 3: Visualize Results<a class="anchor" aria-label="anchor" href="#step-3-visualize-results"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></code></pre></div>
<p>This creates a multi-panel visualization showing:</p>
<ul>
<li>Original image</li>
<li>Color-masked image</li>
<li>Color proportions</li>
<li>Color histogram</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="understanding-the-pipeline">Understanding the Pipeline<a class="anchor" aria-label="anchor" href="#understanding-the-pipeline"></a>
</h2>
<p>The <code>charisma</code> workflow consists of three main stages:</p>
<div class="section level3">
<h3 id="image-preprocessing">1. Image Preprocessing<a class="anchor" aria-label="anchor" href="#image-preprocessing"></a>
</h3>
<p>Images are pre-processed using the <code>recolorize</code> package
to:</p>
<ul>
<li>Perform spatial-color binning</li>
<li>Remove noisy pixels</li>
<li>Create a smoothed representation of dominant colors</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Control preprocessing with bins and cutoff parameters</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/charisma.html">charisma</a></span><span class="op">(</span></span>
<span>  <span class="va">img_path</span>,</span>
<span>  bins <span class="op">=</span> <span class="fl">4</span>,     <span class="co"># Bins per RGB channel (4^3 = 64 clusters)</span></span>
<span>  cutoff <span class="op">=</span> <span class="fl">20</span>   <span class="co"># Euclidean distance threshold</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="color-classification">2. Color Classification<a class="anchor" aria-label="anchor" href="#color-classification"></a>
</h3>
<p>Each color cluster is converted from RGB to HSV and matched against
the CLUT:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example: Classify a single RGB color</span></span>
<span><span class="fu"><a href="../reference/color2label.html">color2label</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">255</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>    <span class="co"># Red</span></span>
<span><span class="co">#&gt; [1] "red"</span></span>
<span><span class="fu"><a href="../reference/color2label.html">color2label</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">255</span><span class="op">)</span><span class="op">)</span>    <span class="co"># Blue</span></span>
<span><span class="co">#&gt; [1] "blue"</span></span>
<span><span class="fu"><a href="../reference/color2label.html">color2label</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">255</span>, <span class="fl">255</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Yellow</span></span>
<span><span class="co">#&gt; [1] "yellow"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="optional-manual-curation">3. Optional Manual Curation<a class="anchor" aria-label="anchor" href="#optional-manual-curation"></a>
</h3>
<p>In interactive mode, you can manually refine classifications:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/charisma.html">charisma</a></span><span class="op">(</span></span>
<span>  <span class="va">img_path</span>,</span>
<span>  interactive <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  threshold <span class="op">=</span> <span class="fl">0.0</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Interactive operations:</strong></p>
<ul>
<li>
<strong>Merge</strong>: Combine color clusters (e.g.,
<code>c(2,3)</code>)</li>
<li>
<strong>Replace</strong>: Reassign pixels from one cluster to
another</li>
<li>Complete operation history is saved for reproducibility</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="working-with-thresholds">Working with Thresholds<a class="anchor" aria-label="anchor" href="#working-with-thresholds"></a>
</h2>
<p>Thresholds automatically remove colors with low pixel
proportions:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># No threshold - keep all colors</span></span>
<span><span class="va">result_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/charisma.html">charisma</a></span><span class="op">(</span><span class="va">img_path</span>, threshold <span class="op">=</span> <span class="fl">0.0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 5% threshold - remove colors &lt; 5% of image</span></span>
<span><span class="va">result_5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/charisma.html">charisma</a></span><span class="op">(</span><span class="va">img_path</span>, threshold <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 10% threshold - remove colors &lt; 10% of image</span></span>
<span><span class="va">result_10</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/charisma.html">charisma</a></span><span class="op">(</span><span class="va">img_path</span>, threshold <span class="op">=</span> <span class="fl">0.10</span><span class="op">)</span></span></code></pre></div>
<p>Higher thresholds are useful for:</p>
<ul>
<li>Removing image artifacts (shadows, feather overlap in bird
specimens)</li>
<li>Focusing on dominant colors</li>
<li>Reducing noise in automated workflows</li>
</ul>
</div>
<div class="section level2">
<h2 id="saving-and-loading-results">Saving and Loading Results<a class="anchor" aria-label="anchor" href="#saving-and-loading-results"></a>
</h2>
<p>Save results for reproducibility:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Save with automatic timestamping</span></span>
<span><span class="va">out_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"~"</span>, <span class="st">"Documents"</span>, <span class="st">"charisma_outputs"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/charisma.html">charisma</a></span><span class="op">(</span></span>
<span>  <span class="va">img_path</span>,</span>
<span>  threshold <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  logdir <span class="op">=</span> <span class="va">out_dir</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>This creates:</p>
<ul>
<li>
<code>charisma_objects/</code>: Timestamped .RDS files (full
charisma object)</li>
<li>
<code>diagnostic_plots/</code>: Timestamped .PDF files
(visualization)</li>
</ul>
<p>Load and re-analyze saved objects:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load saved object</span></span>
<span><span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"path/to/charisma_object.RDS"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Re-analyze with different threshold</span></span>
<span><span class="va">result2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/charisma2.html">charisma2</a></span><span class="op">(</span></span>
<span>  <span class="va">obj</span>,</span>
<span>  new.threshold <span class="op">=</span> <span class="fl">0.10</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Revert to specific state</span></span>
<span><span class="va">result3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/charisma2.html">charisma2</a></span><span class="op">(</span></span>
<span>  <span class="va">obj</span>,</span>
<span>  which.state <span class="op">=</span> <span class="st">"merge"</span>,</span>
<span>  state.index <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="extracting-color-data">Extracting Color Data<a class="anchor" aria-label="anchor" href="#extracting-color-data"></a>
</h2>
<p>The charisma object contains all classification data:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get unique colors present</span></span>
<span><span class="va">unique_colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get number of colors (k)</span></span>
<span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">unique_colors</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get color proportions</span></span>
<span><span class="va">color_props</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">$</span><span class="va">color_mask_LUT_filtered</span></span>
<span></span>
<span><span class="co"># Create presence/absence matrix</span></span>
<span><span class="va">summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/summarize.html">summarize</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="custom-color-look-up-tables">Custom Color Look-Up Tables<a class="anchor" aria-label="anchor" href="#custom-color-look-up-tables"></a>
</h2>
<p>The default CLUT covers 10 human-visible colors, but you can create
custom CLUTs:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># View default CLUT</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/View.html" class="external-link">View</a></span><span class="op">(</span><span class="fu">charisma</span><span class="fu">::</span><span class="va"><a href="../reference/clut.html">clut</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use custom CLUT</span></span>
<span><span class="va">my_clut</span> <span class="op">&lt;-</span> <span class="fu">charisma</span><span class="fu">::</span><span class="va"><a href="../reference/clut.html">clut</a></span>  <span class="co"># Start with default</span></span>
<span></span>
<span><span class="co"># ... modify HSV ranges ...</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/charisma.html">charisma</a></span><span class="op">(</span><span class="va">img_path</span>, clut <span class="op">=</span> <span class="va">my_clut</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Validate custom CLUT (ensures complete HSV coverage)</span></span>
<span><span class="va">validation</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/validate.html">validate</a></span><span class="op">(</span>clut <span class="op">=</span> <span class="va">my_clut</span><span class="op">)</span></span></code></pre></div>
<p><strong>CLUT validation</strong> tests every HSV coordinate to
ensure:</p>
<ol style="list-style-type: decimal">
<li>No gaps (every color maps to a category)</li>
<li>No overlaps (each color maps to exactly one category)</li>
</ol>
</div>
<div class="section level2">
<h2 id="integration-with-evolutionary-analyses">Integration with Evolutionary Analyses<a class="anchor" aria-label="anchor" href="#integration-with-evolutionary-analyses"></a>
</h2>
<p><code>charisma</code> output integrates seamlessly with phylogenetic
packages:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Process multiple species</span></span>
<span><span class="va">species_colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">image_paths</span>, <span class="kw">function</span><span class="op">(</span><span class="va">img</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/charisma.html">charisma</a></span><span class="op">(</span><span class="va">img</span>, threshold <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/summarize.html">summarize</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine into data frame</span></span>
<span><span class="va">color_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">species_colors</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use with geiger, phytools, pavo, etc.</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">geiger</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/liamrevell/phytools" class="external-link">phytools</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit evolutionary models</span></span>
<span><span class="va">fit_er</span> <span class="op">&lt;-</span> <span class="fu">fitDiscrete</span><span class="op">(</span></span>
<span>  <span class="va">phylogeny</span>,</span>
<span>  <span class="va">color_matrix</span><span class="op">[</span>, <span class="st">"blue"</span><span class="op">]</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"ER"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_ard</span> <span class="op">&lt;-</span> <span class="fu">fitDiscrete</span><span class="op">(</span></span>
<span>  <span class="va">phylogeny</span>,</span>
<span>  <span class="va">color_matrix</span><span class="op">[</span>, <span class="st">"blue"</span><span class="op">]</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"ARD"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Reconstruct ancestral states</span></span>
<span><span class="va">ancestral</span> <span class="op">&lt;-</span> <span class="fu">ace</span><span class="op">(</span></span>
<span>  <span class="va">color_matrix</span><span class="op">[</span>, <span class="st">"blue"</span><span class="op">]</span>,</span>
<span>  <span class="va">phylogeny</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"discrete"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="tips-for-best-results">Tips for Best Results<a class="anchor" aria-label="anchor" href="#tips-for-best-results"></a>
</h2>
<div class="section level3">
<h3 id="for-bird-museum-specimens">For Bird Museum Specimens<a class="anchor" aria-label="anchor" href="#for-bird-museum-specimens"></a>
</h3>
<ul>
<li>Use <strong>manual mode</strong> to remove feather artifact colors
(brown/grey from feather bases)</li>
<li>Set <code>threshold = 0.0</code> and manually curate</li>
<li>Remove bill, leg, and tag pixels before analysis</li>
</ul>
</div>
<div class="section level3">
<h3 id="for-automated-workflows">For Automated Workflows<a class="anchor" aria-label="anchor" href="#for-automated-workflows"></a>
</h3>
<ul>
<li>Test different <code>threshold</code> values on a subset</li>
<li>Use <code>bins = 4</code> and <code>cutoff = 20</code> as starting
points</li>
<li>Save all intermediate results with <code>logdir</code>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="for-custom-image-sets">For Custom Image Sets<a class="anchor" aria-label="anchor" href="#for-custom-image-sets"></a>
</h3>
<ul>
<li>Validate that the default CLUT works for your images</li>
<li>Consider creating a custom CLUT for non-biological images</li>
<li>Always validate custom CLUTs with <code><a href="../reference/validate.html">validate()</a></code>
</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>If you use <code>charisma</code> in your research, please cite:</p>
<blockquote>
<p>Schwartz, S.T., Tsai, W.L.E., Karan, E.A., Juhn, M.S., Shultz, A.J.,
McCormack, J.E., Smith, T.B., and Alfaro, M.E. (2025). charisma: An R
package to perform reproducible color characterization of digital images
for biological studies. (In Review).</p>
</blockquote>
</div>
<div class="section level2">
<h2 id="getting-help">Getting Help<a class="anchor" aria-label="anchor" href="#getting-help"></a>
</h2>
<ul>
<li>
<strong>Documentation</strong>: <code><a href="../reference/charisma.html">?charisma</a></code>,
<code><a href="../reference/charisma2.html">?charisma2</a></code>, <code><a href="../reference/color2label.html">?color2label</a></code>
</li>
<li>
<strong>Issues</strong>: <a href="https://github.com/shawntz/charisma/issues" class="external-link uri">https://github.com/shawntz/charisma/issues</a>
</li>
<li>
<strong>Email</strong>: <a href="mailto:shawn.t.schwartz@gmail.com" class="email">shawn.t.schwartz@gmail.com</a>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="acknowledgments">Acknowledgments<a class="anchor" aria-label="anchor" href="#acknowledgments"></a>
</h2>
<p><code>charisma</code> builds upon and integrates with:</p>
<ul>
<li>
<a href="https://cran.r-project.org/package=recolorize" class="external-link"><code>recolorize</code></a>
(Weller et al. 2024) for image preprocessing</li>
<li>
<a href="https://cran.r-project.org/package=pavo" class="external-link"><code>pavo</code></a>
(Maia et al. 2019) for color pattern geometry</li>
<li>
<a href="https://cran.r-project.org/package=imager" class="external-link"><code>imager</code></a>
(Barthelme, 2025) for image processing operations</li>
</ul>
<p>We thank the developers of these excellent packages for making this
work possible.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://scholar.google.com/citations?user=xII63_wAAAAJ&amp;hl=en&amp;oi=ao" class="external-link">Shawn T. Schwartz</a> and <a href="https://scholar.google.com/citations?user=c49cEeYAAAAJ&amp;hl=en&amp;oi=ao" class="external-link">Whitney L.E. Tsai</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> and ❤️. Provided without any warranty.</p>
</div>

    </footer>
</div>





  </body>
</html>
